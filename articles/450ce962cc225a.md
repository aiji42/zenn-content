---
title: "[Next.js] ã‚¢ã‚¯ã‚»ã‚¹ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ã‚¿ãƒ¼ãƒ³"
emoji: "ğŸ§±"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["nextjs","typescript","react"]
published: false
---

## ã¯ã˜ã‚ã«

Next.js ã§ MPA ã‚’æ§‹ç¯‰ã—ã¦ã„ã‚‹ã¨ã€ãƒšãƒ¼ã‚¸å˜ä½ã§ã‚¢ã‚¯ã‚¢ã‚»ã‚¹ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’è¡Œã„ãŸã„ã¨ã„ã†ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚
ã“ã“ã§ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã¯ã€ãƒšãƒ¼ã‚¸ã”ã¨ã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªæ¡ä»¶ã‚’å®šç¾©ã—ãŸã‚Šã€æ¡ä»¶ã«ããã‚ãªã„å ´åˆã«åˆ¥ã®ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã›ã‚‹ãƒ«ãƒ¼ãƒ«ãŠã‚ˆã³å‡¦ç†ã‚’æ„å‘³ã—ã¾ã™ã€‚

ä¾‹ãˆã°ã€ä¸€èˆ¬å‘ã‘ã®ãƒšãƒ¼ã‚¸ã¨ã€ç™»éŒ²æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶å‘ã‘ã®ãƒã‚¤ãƒšãƒ¼ã‚¸ã‚’æŒã¤ã‚±ãƒ¼ã‚¹ã‚’è€ƒãˆã¦ã¿ã¾ã™ã€‚
- ä¸€èˆ¬å‘ã‘ãƒšãƒ¼ã‚¸ã¯èª°ã§ã‚‚ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
- ãƒã‚¤ãƒšãƒ¼ã‚¸ã¯ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ã®ãƒ¦ãƒ¼ã‚¶ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
- ãƒ­ã‚°ã‚¤ãƒ³ã®ãŸã‚ã®ã‚µã‚¤ãƒ³ã‚¤ãƒ³ãƒ»ã‚¢ãƒƒãƒ—ãƒ•ã‚©ãƒ¼ãƒ ã®ãƒšãƒ¼ã‚¸ã‚‚å­˜åœ¨ã™ã‚‹ãŒã€ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ã§ã‚ã‚Œã°ãƒã‚¤ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã‚‹
    - ãŸã ã—ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆã®ãƒ•ã‚©ãƒ¼ãƒ ã¯èª°ã§ã‚‚ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½

ä»Šå›ã¯ä¸Šè¨˜ã®ãƒ«ãƒ¼ãƒ«ã‚’å®Ÿè£…ã™ã‚‹ä¸Šã§ã®ã€ã„ãã¤ã‹ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è€ƒãˆã¾ã™ã€‚

## ãƒ‘ã‚¿ãƒ¼ãƒ³1: å„ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒãƒ³ãƒˆå†…ã§åˆ¶å¾¡ã™ã‚‹

ã¾ãšã¯å„ãƒšãƒ¼ã‚¸ã§ã‚¢ã‚¯ã‚»ã‚¹ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’è¡Œã†ã‚±ãƒ¼ã‚¹ã§ã™ã€‚
ä¾¿å®œä¸Š `isLoggedIn()` ã®å®Ÿè£…ã¯çœç•¥ã—ã¾ã™ã€‚

```tsx
// pages/mypage.tsx
const Mypage: VFX = (props) => {
  const router = useRouter()
  if (!isLoggedIn()) router.replace('/signin') // ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ãªã‘ã‚Œã°ã‚µã‚¤ãƒ³ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã¸è»¢é€

  return <>...</>
}

export default Mypage
```

```tsx
// pages/signin.tsx
const Signin: VFX = (props) => {
  const router = useRouter()
  if (isLoggedIn()) router.replace('/mypage') // ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ã§ã‚ã‚Œã°ãƒã‚¤ãƒšãƒ¼ã‚¸ã¸è»¢é€

  return <>...</>
}

export default Signin
```

ã“ã®ã‚±ãƒ¼ã‚¹ã¯éå¸¸ã«ã‚·ãƒ³ãƒ—ãƒ«ã§ã™ã€‚ãŠãã‚‰ãèª°ã‚‚ãŒä¸€ç•ªæœ€åˆã«æ€ã„ã¤ããƒ‘ã‚¿ãƒ¼ãƒ³ã§ã™ã€‚
ãƒšãƒ¼ã‚¸æ•°ãŒå°‘ãªã„ã†ã¡ã¯ã“ã‚Œã§å•é¡Œãªã„ã®ã§ã™ãŒã€ãƒšãƒ¼ã‚¸æ•°ãŒå¢—ãˆã¦ãã‚‹ã¨ç ´ç¶»ã—ã‚„ã™ããªã‚Šã¾ã™ã€‚
ä¾‹ãˆã°ã€`/mypage/a` `/mypage/b` `/mypage/c` ã®ã‚ˆã†ã«è¤‡æ•°ãƒšãƒ¼ã‚¸ã‚ã‚‹å ´åˆã€libs ç­‰ã«åˆ¶å¾¡å‡¦ç†ã‚’åˆ‡ã‚Šå‡ºã—ã¦å…±é€šåŒ–ã—ã¾ã™ãŒã€ãã†ã™ã‚‹ã¨è¨˜è¿°å¿˜ã‚ŒãŒç™ºç”Ÿã—ãˆã¾ã™ã€‚

- **Pros**
   - ã‚·ãƒ³ãƒ—ãƒ«
   - ä»–ãƒšãƒ¼ã‚¸ã®åˆ¶å¾¡æƒ…å ±ã‚’ä¿ã¤å¿…è¦ãŒãªã„ã®ã§ã€é–¢å¿ƒåˆ†é›¢ãŒè¡Œãˆã¦ã„ã‚‹
- **Cons**
   - è¨­å®šã—å¿˜ã‚ŒãŒèµ·ã“ã‚Šå¾—ã‚‹
   

## ãƒ‘ã‚¿ãƒ¼ãƒ³2: _app.ts ã§é›†ä¸­ç®¡ç†ã™ã‚‹

```tsx
// pages/_app.tsx

const useAccessControll = () => {
  const router = useRouter()
  useEffect(() => {
    if (router.asPath === '/mypage' && !isLoggedIn())
      router.replace('/signin')
    if (router.asPath === '/signin'  && !isLoggedIn())
      router.replace('/mypge')
  }, [router]) 
}

const App: VFX<AppProps> = ({ Component, pageProps }) => {
  return <Component {...pageProps} />
}

export default App
```


## ãƒ‘ã‚¿ãƒ¼ãƒ³3: getAccessControl


## ç•ªå¤–ç·¨: ã‚µãƒ¼ãƒã‚µã‚¤ãƒ‰ã§åˆ¶å¾¡ã™ã‚‹